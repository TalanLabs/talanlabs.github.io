<!doctype html><html lang=fr-fr>
<head><title> Datomic la base de données qui n'oublie rien | Talan Labs | Blog
</title>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<meta content="width=device-width,initial-scale=1,maximum-scale=5" name=viewport>
<meta name=description content="Cette année à Devoxx au rayon Big Data on pouvait assister à la présentation de Datomic, une base de données NoSQL.">
<meta property="og:title" content="Datomic la base de données qui n'oublie rien">
<meta property="og:description" content="Cette année à Devoxx au rayon Big Data on pouvait assister à la présentation de Datomic, une base de données NoSQL.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://blog.talanlabs.com/datomic-base-de-donnees-noublie-rien/"><meta property="og:image" content="https://blog.talanlabs.com/datomic-base-de-donnees-noublie-rien/cover.jpg"><meta property="article:section" content="post">
<meta property="article:published_time" content="2015-06-26T13:33:58+00:00">
<meta property="article:modified_time" content="2015-06-26T13:33:58+00:00"><meta property="og:site_name" content="Talan Labs | Blog">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://blog.talanlabs.com/datomic-base-de-donnees-noublie-rien/cover.jpg">
<meta name=twitter:title content="Datomic la base de données qui n'oublie rien">
<meta name=twitter:description content="Cette année à Devoxx au rayon Big Data on pouvait assister à la présentation de Datomic, une base de données NoSQL.">
<script type=text/javascript src=/js/mermaid.min.js></script>
<script type=text/javascript src=/js/tarteaucitron.js-1.9.3/tarteaucitron.js></script>
<link rel=icon type=image/png sizes=96x96 href=/img/favicon.png>
<link rel=canonical href=https://blog.talanlabs.com/datomic-base-de-donnees-noublie-rien/>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/highlight.js@11.3.1/styles/monokai.css type=text/css>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/highlight.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/languages/asciidoc.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/languages/http.min.js></script>
<script>hljs.highlightAll()</script>
<link href=/css/main.css rel=stylesheet>
<link rel=stylesheet href=https://rsms.me/inter/inter.css>
</head>
<link rel=preconnect href=https://fonts.gstatic.com>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;800&display=swap" rel=stylesheet>
<script defer src=https://use.fontawesome.com/releases/v5.14.0/js/all.js></script>
</head>
<body><div class="sticky top-0 w-full bg-white dark:bg-black">
<div class="max-w-8xl mx-auto">
<div class="py-4 border-b border-slate-900/10 lg:px-8 lg:border-0 mx-4 lg:mx-0">
<div class="relative flex items-center justify-between">
<a class="level-item has-text-centered" href=/>
<img class="dark:hidden h-14 inline" height=30 src=/img/logo_talanlabs_hd_h55.png alt="Logo Talan Labs">
<img class="h-14 inline" height=30 src=/img/logo_talanlabs_white_small.png alt="Logo Talan Labs">
</a>
<div class="relative hidden md:flex items-center ml-auto">
<ul class="flex space-x-8">
<ul class="flex space-x-8">
<li>
<a class="hover:text-blue-500 dark:text-white" href=/post target=_parent>Publications</a>
</li>
<li>
<a class="hover:text-blue-500 dark:text-white" href=/events/ target=_parent>Evènements </a>
</li>
<li>
<a class="hover:text-blue-500 dark:text-white" href=/startup-network target=_parent>Sun</a>
</li>
<li>
<a class="hover:text-blue-500 dark:text-white" href=/authors/ target=_parent>Auteurs</a>
</li>
<li>
<a class="hover:text-blue-500 dark:text-white" href=/contact-us target=_parent>Contact</a>
</li>
</ul>
</ul>
<div class="flex items-center border-l border-slate-200 ml-6 pl-6">
<label class=sr-only id=headlessui-listbox-label-3>Theme</label>
<button type=button id=theme-toggle aria-haspopup=true aria-expanded=false aria-labelledby=theme-toggle>
<span class=hidden id=theme-toggle-light-icon>
<svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6"><path d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" class="stroke-slate-400 dark:stroke-slate-500"/><path d="M12 4v1m5.66 1.344-.828.828m3.173 4.832h-1m-1.345 5.66-.828-.828M12 20.01V19M6.34 17.664l.835-.836m-3.18-4.824h1.01M6 6l.835.836" class="stroke-slate-400 dark:stroke-slate-500"/></svg></span>
<span id=theme-toggle-dark-icon><svg viewBox="0 0 24 24" fill="none" class="w-6 h-6"><path fill-rule="evenodd" clip-rule="evenodd" d="M17.715 15.15A6.5 6.5.0 019 6.035c-2.894.887-5 3.61-5 6.832.0 3.94 3.153 7.136 7.042 7.136 3.101.0 5.734-2.032 6.673-4.853z" class="fill-transparent"/><path d="m17.715 15.15.95.316a1 1 0 00-1.445-1.185l.495.869zM9 6.035l.846.534a1 1 0 00-1.14-1.49L9 6.035zm8.221 8.246a5.47 5.47.0 01-2.72.718v2a7.47 7.47.0 003.71-.98l-.99-1.738zm-2.72.718A5.5 5.5.0 019 9.5H7a7.5 7.5.0 007.5 7.5v-2zM9 9.5c0-1.079.31-2.082.845-2.93L8.153 5.5A7.47 7.47.0 007 9.5h2zm-4 3.368C5 10.089 6.815 7.75 9.292 6.99L8.706 5.08C5.397 6.094 3 9.201 3 12.867h2zm6.042 6.136C7.718 19.003 5 16.268 5 12.867H3c0 4.48 3.588 8.136 8.042 8.136v-2zm5.725-4.17c-.81 2.433-3.074 4.17-5.725 4.17v2c3.552.0 6.553-2.327 7.622-5.537l-1.897-.632z" class="fill-slate-400 dark:fill-slate-500"/><path fill-rule="evenodd" clip-rule="evenodd" d="M17 3a1 1 0 011 1 2 2 0 002 2 1 1 0 110 2 2 2 0 00-2 2 1 1 0 11-2 0 2 2 0 00-2-2 1 1 0 110-2 2 2 0 002-2 1 1 0 011-1z" class="fill-slate-400 dark:fill-slate-500"/></svg>
</span>
</div>
</div>
<div class="md:hidden flex items-center">
<button class="outline-none mobile-menu-button"><svg class="w-6 h-6 text-gray-500 hover:text-blue-500" x-show="!showMenu" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentcolor"><path d="M4 6h16M4 12h16M4 18h16"/></svg>
</button>
</div>
</div>
</div>
</div>
<div class="hidden mobile-menu md:hidden">
<ul>
<li>
<a class="block text-sm px-2 py-4 hover:bg-blue-500 dark:text-white" href=/post target=_parent>Publications</a>
</li>
<li>
<a class="block text-sm px-2 py-4 hover:bg-blue-500 dark:text-white" href=/events/ target=_parent>Evènements </a>
</li>
<li>
<a class="block text-sm px-2 py-4 hover:bg-blue-500 dark:text-white" href=/startup-network target=_parent>Sun</a>
</li>
<li>
<a class="block text-sm px-2 py-4 hover:bg-blue-500 dark:text-white" href=/authors/ target=_parent>Auteurs</a>
</li>
<li>
<a class="block text-sm px-2 py-4 hover:bg-blue-500 dark:text-white" href=/contact-us target=_parent>Contact</a>
</li>
</ul>
</div>
<script>const btn=document.querySelector("button.mobile-menu-button"),menu=document.querySelector(".mobile-menu");btn.addEventListener("click",()=>{menu.classList.toggle("hidden")})</script>
</div>
<div class="container mx-auto px-6 mt-14">
<div class=md:flex>
<div class="content post w-full md:mr-8">
<h1 class=title>Datomic la base de données qui n'oublie rien</h1>
<figure class="cover image">
<img src=/datomic-base-de-donnees-noublie-rien/cover.jpg width=744 height=732 alt="illustration de l'article">
</figure>
<p>Cette année à Devoxx au rayon Big Data on pouvait assister à la présentation de Datomic, une base de données NoSQL. Voici ce qu&rsquo;elle recèle.</p>
<p>Conçue depuis 2012 par Rich Hickey, Datomic se veut une base simple, transactionnelle, distribuée, flexible, évolutive, taillée pour les architecture cloud. Cette dernière se présente de la façon suivante :</p>
<p><img src=datomic.jpg alt=datomic></p>
<p>Derrière ce schéma un peu barbare, retenons que Datomic se base sur 3 concepts</p>
<ul>
<li>Peer</li>
</ul>
<p>Correspond à une librairie installable coté serveur d&rsquo;application. Il sert de passerelle avec le reste de la base : soumet les transactions et reçoit les changements du Transactor. Il fournit également la couche d&rsquo;accès aux données, un système de cache et un moteur de requêtes (Datalog). Il gère toutes les communications utiles pour la connexion au Transactor et systèmes de stockage ainsi qu&rsquo;avec le Datalog. Dernier point le Peer peut se lancer en mode standalone en utilisant une base montée en mémoire.</p>
<ul>
<li>Transactor</li>
</ul>
<p>est unique (1 seul processus) et est obligatoire dès que le nombre de Peer est supérieur à 1 ou qu&rsquo;il exploite un service de stockage. Il est chargé de recevoir et de coordonner les changements par ordre chronologique. De ce fait Datomic répond aux principes ACID des transactions. Il transmet les changements aux Peers et s&rsquo;occupe de l&rsquo;indexation via un processus d&rsquo;arrière-plan.</p>
<ul>
<li>Stockage</li>
</ul>
<p>Peut être un service interne ou externe. Pour un service externe Datomic est capable de se brancher avec DynamoDB, Riak, Cassandra, Couchbase, Infinispan ou une base SQL comme PostgreSQL.</p>
<p>Après l&rsquo;architecture attardons nous sur la philosophie de Datomic. Rich Hickey est parti du constat que les bases de données relationnelles qu&rsquo;on connait se repose sur un modèle sensiblement dépassé. En effet cette représentation des données a vu le jour il y a quelques dizaines d&rsquo;années où les contraintes en terme de stockage étaient fortes, ce qui n&rsquo;est plus le cas aujourd&rsquo;hui.</p>
<p>L&rsquo;idée était d&rsquo;abandonner la méthode de Place-oriented Programming (trouve puis écrase la valeur) historique pour mettre en place une gestion des faits. Datomic se base sur des faits (qui a dit Memento ?)</p>
<p>Mais qu&rsquo;est-ce qu&rsquo;un fait ? Un fait est :</p>
<ul>
<li>Immuable</li>
<li>Atomique (concerne un seul élément)</li>
<li>Temporel</li>
</ul>
<p>Avec Datomic un fait se nomme un &ldquo;Datom&rdquo;, un Datom correspond à</p>
<ul>
<li>Entité</li>
<li>Attribut</li>
<li>Valeur</li>
<li>Transaction (correspond à un temps base)</li>
<li>Opération</li>
</ul>
<p>A travers ses Datoms, Datomic est construit sur un unique schéma de table (se rapprochant des modèles schemaless): la notion de base de données est donc l&rsquo;ensemble des datoms enregistrés. Dans la dernière version le nombre maximum de datoms est de 10 milliards par base.</p>
<p>Revenons sur un détail : un fait est immuable. Vous vous dites comment une donnée peut être immuable, est-il impossible de changer les faits ? Dans ce cas oui puisque que les faits sont associés à une temporalité : Tim Cook est devenu le président d&rsquo;Apple, ça ne veut pas dire pour autant que Steve Jobs n&rsquo;a jamais été président d&rsquo;Apple. Ainsi une modification est réalisée par l&rsquo;ajout d&rsquo;un nouveau fait (ici par exemple pour répondre à la question &ldquo;qui est le président d&rsquo;Apple ? &ldquo;). En ce qui concerne la suppression, celle-ci se fait de manière logique par le biais du booléen Opération du modèle de données.</p>
<p>Nico, aime, pizza, 1001, true</p>
<p>Nico, aime, biere, 1001, true</p>
<p>Nico, aime, vodka-martini, 1001, true</p>
<p>Nico, aime, ginto, 1002, true</p>
<p>Nico, aime, biere, 1002, false</p>
<p>On peut voir l&rsquo;ajout de faits dans Datomic comme la croissance d&rsquo;un arbre, chaque transaction est un anneau de l&rsquo;arbre. Ce qui amène à l&rsquo;une des spécificités de Datomic, il est possible de revenir à l&rsquo;état exact de la base de données (à une transaction donnée) : Datomic permet le voyage dans le temps.</p>
<p>Datomic propose un système de covering index c&rsquo;est-à-dire que le contenu des 5 colonnes est indexé. Le Transactor se charge d&rsquo;actualiser les index et les données indexées sont poussées aux Peers pour exploitation dans leur cache et l’exécution des requêtes.</p>
<p>Quelques spécificités supplémentaires :</p>
<ul>
<li>Datomic supporte Datalog comme langage de requêtage</li>
<li>La possibilité de faire des transactions spéculatives c&rsquo;est-à-dire de ne pas les envoyer au Transactor. Les modifications apportées sont visibles uniquement en local</li>
<li>Grâce à son architecture, les lectures sont dissociées des écritures.</li>
</ul>
<p>Datomic propose une gestion simple de données temporelles avec une forte évolutivité de capacité de lectures tout en garantissant une gestion transactionnelle des données. Il limite également toute une partie du traffic réseau avec sa gestion locale de cache et de requêtes. Ce dernier point amène aussi un inconvénient majeur puisque en raison de ses caractéristiques ACID la montée en charge en terme d&rsquo;écriture risque d&rsquo;être sensible et complexe comparé à d&rsquo;autres solutions NoSQL.</p>
<p>Datamic trouvera donc un intérêt pour toute application de gestion avec un fort besoin de rapidité de réponse. Le meilleur cas reste quand même le besoin d&rsquo;historisation des données puisque l&rsquo;architecture Datomic est idéalement taillée pour.</p>
</div>
<div class="content md:flex-col md:w-72 text-center">
<div class="bg-stone-100 px-4 pb-4 rounded">
<div>
<h4 class=subtitle><i class="fas fa-calendar-alt"></i> Date</h4>
<time datetime=2015-06-26T13:33:58Z>
26 juin 2015
</time>
</div>
<div>
<h4 class=subtitle><i class="fas fa-pen"></i> Auteur</h4>
<div class=text-center>
<div class=mb-4>
<figure>
<a href=https://blog.talanlabs.com/authors/timothe-fulcrand/><img class="h-36 w-36 m-0 inline-block object-cover rounded-full border border-gray-100" alt="Avatar Timothé FULCRAND" src=https://blog.talanlabs.com/authors/timothe_fulcrand.jpg></a>
</figure>
</div>
<div>
<h1 class="text-3xl pb-0 text-center font-medium"><a href=https://blog.talanlabs.com/authors/timothe-fulcrand/>Timothé FULCRAND</a></h1>
<p class="mt-0 mb-2">DBA</p>
</div>
<div class=mb-6>
<a href=https://www.linkedin.com/in/timoth%c3%a9-fulcrand-02951924 target=_blank class="icon is-medium"><i class="fab fa-lg fa-linkedin text-[#0077B5]"></i></a>
</div>
</div>
</div>
<div>
<h4 class=subtitle><i class="fas fa-hashtag"></i> Catégories</h4>
<a class="py-0.5 px-4 my-2 rounded bg-cyan-500 text-white whitespace-nowrap" href=/categories/architecture>architecture</a>
<a class="py-0.5 px-4 my-2 rounded bg-cyan-500 text-white whitespace-nowrap" href=/categories/data>data</a>
</div>
<div>
<h4 class=subtitle><i class="fas fa-hashtag"></i> Tags</h4>
<a class="py-0.5 px-4 my-2 rounded bg-indigo-500 text-white whitespace-nowrap hover:bg-indigo-200 hover:text-slate-900" href=/tags/datomic>#Datomic</a>
</div>
</div>
</div>
</div>
</aside>
</div>
<footer class="w-full bg-gray-100 p-8 dark:bg-black">
<div class="container flex flex-row flex-wrap mx-auto gap-8">
<div class=w-48>
<h3 class="subtitle mt-6 mb-4 ml-0 dark:text-white">Talan Labs</h3>
<nav role=navigation aria-label="footer navigation">
<ul>
<li><a class=dark:text-white href=https://talan.com/metiers/labs/ target=_blank rel=noopener><i class="fas fa-link"></i> Site web</a></li>
<li><a class=dark:text-white href=https://twitter.com/TalanLabs target=_blank rel=noopener><i class="fab fa-twitter"></i> Twitter</a></li>
<li><a class=dark:text-white href=https://www.linkedin.com/company/talanlabs/ target=_blank rel=noopener><i class="fab fa-linkedin"></i> LinkedIn</a></li>
<li><a class=dark:text-white href=https://github.com/TalanLabs target=_blank rel=noopener><i class="fab fa-github"></i> GitHub</a></li>
</ul>
</nav>
</div>
<div class=w-48>
<h3 class="subtitle mt-6 mb-4 ml-0 dark:text-white">Le groupe Talan</h3>
<nav role=navigation aria-label="footer navigation">
<ul>
<li><a class=dark:text-white href=https://talan.com/ target=_blank rel=noopener><i class="fas fa-link"></i> Site
web</a></li>
<li><a class=dark:text-white href=https://twitter.com/talan_fr target=_blank rel=noopener><i class="fab fa-twitter"></i> Twitter</a></li>
<li><a class=dark:text-white href=https://www.linkedin.com/company/talan/ target=_blank rel=noopener><i class="fab fa-linkedin"></i> LinkedIn</a></li>
<li><a class=dark:text-white href=https://www.facebook.com/talan/ target=_blank rel=noopener><i class="fab fa-facebook"></i> Facebook</a></li>
</ul>
</nav>
</div>
</div>
<div class="text-center mt-3 dark:text-white">© 2022 - Le Blog des Labs de Talan - Construit avec <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> et <a href=hhttps://tailwindcss.com target=_blank rel=noopener>Tailwindcss</a></div>
</footer>
<script>var themeToggleDarkIcon=document.getElementById('theme-toggle-dark-icon'),themeToggleLightIcon=document.getElementById('theme-toggle-light-icon'),themeToggleBtn;localStorage.getItem('color-theme')==='dark'||!('color-theme'in localStorage)&&window.matchMedia('(prefers-color-scheme: dark)').matches?(themeToggleLightIcon.classList.remove('hidden'),themeToggleDarkIcon.classList.add('hidden'),document.documentElement.classList.add('dark')):(themeToggleLightIcon.classList.add('hidden'),themeToggleDarkIcon.classList.remove('hidden'),document.documentElement.classList.remove('dark')),themeToggleBtn=document.getElementById('theme-toggle'),themeToggleBtn.addEventListener('click',function(){themeToggleDarkIcon.classList.toggle('hidden'),themeToggleLightIcon.classList.toggle('hidden'),localStorage.getItem('color-theme')?localStorage.getItem('color-theme')==='light'?(document.documentElement.classList.add('dark'),localStorage.setItem('color-theme','dark')):(document.documentElement.classList.remove('dark'),localStorage.setItem('color-theme','light')):document.documentElement.classList.contains('dark')?(document.documentElement.classList.remove('dark'),localStorage.setItem('color-theme','light')):(document.documentElement.classList.add('dark'),localStorage.setItem('color-theme','dark'))})</script><script type=text/javascript>tarteaucitron.init({privacyUrl:"",hashtag:"#tarteaucitron",cookieName:"tarteaucitron",orientation:"bottom",groupServices:!0,showAlertSmall:!1,cookieslist:!1,closePopup:!1,showIcon:!0,iconSrc:"https://blog.talanlabs.com/cookie.png",iconPosition:"BottomRight",adblocker:!1,DenyAllCta:!0,AcceptAllCta:!0,highPrivacy:!0,handleBrowserDNTRequest:!1,removeCredit:!0,moreInfoLink:!0,useExternalCss:!1,useExternalJs:!1,readmoreLink:"",mandatory:!1})</script>
<script type=text/javascript>var tarteaucitronForceLanguage='fr'</script>
<script type=text/javascript>tarteaucitron.user.multiplegtagUa=['UA-40718882-5','G-MED3GXXYSF'],(tarteaucitron.job=tarteaucitron.job||[]).push('multiplegtag')</script>
<script type=text/javascript></script>
</body>
</html>