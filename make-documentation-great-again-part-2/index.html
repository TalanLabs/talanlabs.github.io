<!doctype html><html lang=fr-fr>
<head><title> Make documentation great again (2/2) | Talan Labs | Blog
</title>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<meta content="width=device-width,initial-scale=1,maximum-scale=5" name=viewport>
<meta name=description content="
L’une des valeurs de l’agilité est &#34;un logiciel fonctionnel plutôt qu’une documentation exhaustive&#34; …​ et si on faisait les deux ?!

">
<meta property="og:title" content="Make documentation great again (2/2)">
<meta property="og:description" content="
L’une des valeurs de l’agilité est &#34;un logiciel fonctionnel plutôt qu’une documentation exhaustive&#34; …​ et si on faisait les deux ?!

">
<meta property="og:type" content="article">
<meta property="og:url" content="https://blog.talanlabs.com/make-documentation-great-again-part-2/"><meta property="og:image" content="https://blog.talanlabs.com/make-documentation-great-again-part-2/cover.jpg"><meta property="article:section" content="post">
<meta property="article:published_time" content="2021-11-08T00:00:00+02:00">
<meta property="article:modified_time" content="2021-11-08T00:00:00+02:00"><meta property="og:site_name" content="Talan Labs | Blog">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://blog.talanlabs.com/make-documentation-great-again-part-2/cover.jpg">
<meta name=twitter:title content="Make documentation great again (2/2)">
<meta name=twitter:description content="
L’une des valeurs de l’agilité est &#34;un logiciel fonctionnel plutôt qu’une documentation exhaustive&#34; …​ et si on faisait les deux ?!

">
<script type=text/javascript src=/js/mermaid.min.js></script>
<script type=text/javascript src=/js/tarteaucitron.js-1.9.3/tarteaucitron.js></script>
<link rel=icon type=image/png sizes=96x96 href=/img/favicon.png>
<link rel=canonical href=https://alainnicolas.fr/blog/make-documentation-great-again-part-2/>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/highlight.js@11.3.1/styles/monokai.css type=text/css>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/highlight.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/languages/asciidoc.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/languages/http.min.js></script>
<script>hljs.highlightAll()</script>
<link href=/css/main.css rel=stylesheet>
<link rel=stylesheet href=https://rsms.me/inter/inter.css>
</head>
<link rel=preconnect href=https://fonts.gstatic.com>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;800&display=swap" rel=stylesheet>
<script defer src=https://use.fontawesome.com/releases/v5.14.0/js/all.js></script>
</head>
<body><div class="sticky top-0 w-full bg-white dark:bg-black">
<div class="max-w-8xl mx-auto">
<div class="py-4 border-b border-slate-900/10 lg:px-8 lg:border-0 mx-4 lg:mx-0">
<div class="relative flex items-center justify-between">
<a class="level-item has-text-centered" href=/>
<img class="dark:hidden h-14 inline" height=30 src=/img/logo_talanlabs_hd_h55.png alt="Logo Talan Labs">
<img class="h-14 inline" height=30 src=/img/logo_talanlabs_white_small.png alt="Logo Talan Labs">
</a>
<div class="relative hidden md:flex items-center ml-auto">
<ul class="flex space-x-8">
<ul class="flex space-x-8">
<li>
<a class="hover:text-blue-500 dark:text-white" href=/post target=_parent>Publications</a>
</li>
<li>
<a class="hover:text-blue-500 dark:text-white" href=/events/ target=_parent>Evènements </a>
</li>
<li>
<a class="hover:text-blue-500 dark:text-white" href=/startup-network target=_parent>Sun</a>
</li>
<li>
<a class="hover:text-blue-500 dark:text-white" href=/authors/ target=_parent>Auteurs</a>
</li>
<li>
<a class="hover:text-blue-500 dark:text-white" href=/contact-us target=_parent>Contact</a>
</li>
</ul>
</ul>
<div class="flex items-center border-l border-slate-200 ml-6 pl-6">
<label class=sr-only id=headlessui-listbox-label-3>Theme</label>
<button type=button id=theme-toggle aria-haspopup=true aria-expanded=false aria-labelledby=theme-toggle>
<span class=hidden id=theme-toggle-light-icon>
<svg viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6"><path d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" class="stroke-slate-400 dark:stroke-slate-500"/><path d="M12 4v1m5.66 1.344-.828.828m3.173 4.832h-1m-1.345 5.66-.828-.828M12 20.01V19M6.34 17.664l.835-.836m-3.18-4.824h1.01M6 6l.835.836" class="stroke-slate-400 dark:stroke-slate-500"/></svg></span>
<span id=theme-toggle-dark-icon><svg viewBox="0 0 24 24" fill="none" class="w-6 h-6"><path fill-rule="evenodd" clip-rule="evenodd" d="M17.715 15.15A6.5 6.5.0 019 6.035c-2.894.887-5 3.61-5 6.832.0 3.94 3.153 7.136 7.042 7.136 3.101.0 5.734-2.032 6.673-4.853z" class="fill-transparent"/><path d="m17.715 15.15.95.316a1 1 0 00-1.445-1.185l.495.869zM9 6.035l.846.534a1 1 0 00-1.14-1.49L9 6.035zm8.221 8.246a5.47 5.47.0 01-2.72.718v2a7.47 7.47.0 003.71-.98l-.99-1.738zm-2.72.718A5.5 5.5.0 019 9.5H7a7.5 7.5.0 007.5 7.5v-2zM9 9.5c0-1.079.31-2.082.845-2.93L8.153 5.5A7.47 7.47.0 007 9.5h2zm-4 3.368C5 10.089 6.815 7.75 9.292 6.99L8.706 5.08C5.397 6.094 3 9.201 3 12.867h2zm6.042 6.136C7.718 19.003 5 16.268 5 12.867H3c0 4.48 3.588 8.136 8.042 8.136v-2zm5.725-4.17c-.81 2.433-3.074 4.17-5.725 4.17v2c3.552.0 6.553-2.327 7.622-5.537l-1.897-.632z" class="fill-slate-400 dark:fill-slate-500"/><path fill-rule="evenodd" clip-rule="evenodd" d="M17 3a1 1 0 011 1 2 2 0 002 2 1 1 0 110 2 2 2 0 00-2 2 1 1 0 11-2 0 2 2 0 00-2-2 1 1 0 110-2 2 2 0 002-2 1 1 0 011-1z" class="fill-slate-400 dark:fill-slate-500"/></svg>
</span>
</div>
</div>
<div class="md:hidden flex items-center">
<button class="outline-none mobile-menu-button"><svg class="w-6 h-6 text-gray-500 hover:text-blue-500" x-show="!showMenu" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentcolor"><path d="M4 6h16M4 12h16M4 18h16"/></svg>
</button>
</div>
</div>
</div>
</div>
<div class="hidden mobile-menu md:hidden">
<ul>
<li>
<a class="block text-sm px-2 py-4 hover:bg-blue-500 dark:text-white" href=/post target=_parent>Publications</a>
</li>
<li>
<a class="block text-sm px-2 py-4 hover:bg-blue-500 dark:text-white" href=/events/ target=_parent>Evènements </a>
</li>
<li>
<a class="block text-sm px-2 py-4 hover:bg-blue-500 dark:text-white" href=/startup-network target=_parent>Sun</a>
</li>
<li>
<a class="block text-sm px-2 py-4 hover:bg-blue-500 dark:text-white" href=/authors/ target=_parent>Auteurs</a>
</li>
<li>
<a class="block text-sm px-2 py-4 hover:bg-blue-500 dark:text-white" href=/contact-us target=_parent>Contact</a>
</li>
</ul>
</div>
<script>const btn=document.querySelector("button.mobile-menu-button"),menu=document.querySelector(".mobile-menu");btn.addEventListener("click",()=>{menu.classList.toggle("hidden")})</script>
</div>
<div class="container mx-auto px-6 mt-14">
<div class=md:flex>
<div class="content post w-full md:mr-8">
<h1 class=title>Make documentation great again (2/2)</h1>
<figure class="cover image">
<img src=/make-documentation-great-again-part-2/cover.jpg width=3840 height=2160 alt="illustration de l'article">
</figure>
<div class=paragraph>
<p>Nous avons vu précédemment une <a href=https://alainnicolas.fr/blog/make-documentation-great-again-part-1/ target=_blank rel=noopener>présentation du langage AsciiDoc</a> et des avantages de la "Documentation as Code".</p>
</div>
<div class=paragraph>
<p>Il est néanmoins possible de faciliter encore plus la rédaction de la documentation ! En effet, il est de coutume de documenter l’API que l’on développe, pour faciliter sa maintenance et les interactions avec ses "consommateurs".</p>
</div>
<div class=paragraph>
<p>Même si l’une des 4 valeurs de l’agilité promeut "un logiciel fonctionnel plutôt qu’une documentation exhaustive", nous allons voir que l’on peut proposer les deux en même temps grâce à un outil particulièrement pratique.</p>
</div>
<div class=sect1>
<h2 id=_spring_rest_docs>Spring REST Docs</h2>
<div class=sectionbody>
<div class=paragraph>
<p><a href=https://docs.spring.io/spring-restdocs/docs/current/reference/html5/ target=_blank rel=noopener>Spring REST Docs</a> permet d’alléger grandement la rédaction d’une documentation d’API, en combinant une rédaction manuelle et l’injection de sections autogénérées.</p>
</div>
<div class=paragraph>
<p>Il s’appuie sur Spring MVC Test, largement utilisé pour les tests de la couche "web" d’une application Spring. Autrement dit, son ajout sur un projet déjà entamé ne demandera pas une refonte complète de ses tests …​ et c’est évidemment une bonne chose !</p>
</div>
</div>
</div>
<div class=sect1>
<h2 id=_un_projet_de_démonstration>Un projet de démonstration</h2>
<div class=sectionbody>
<div class=paragraph>
<p>De manière à nous baser sur un exemple concret, je vous propose un petit <a href=https://github.com/alainncls/demo-spring-rest-docs>projet de démonstration</a> disponible sur GitHub.</p>
</div>
<div class=paragraph>
<p>Dans ces cas-là, inutile d’imaginer un cas d’usage très compliqué, j’ai donc mis en place un simple CRUD manipulant un objet <a href=https://github.com/alainncls/demo-spring-rest-docs/blob/main/src/main/java/fr/alainncls/demospringrestdocs/model/Company.java><code>Company</code></a>. Une <code>Company</code> est définie par un ID, un nom, un lieu et une date de création.</p>
</div>
<div class=paragraph>
<p>Pour ressembler à un vrai projet, j’ai tout de même ajouté une interaction avec une base MongoDB qu’il faut démarrer avant de lancer l’application. Pour ajouter une <code>Company</code>, on peut donc faire une requête POST avec comme body :</p>
</div>
<div class=listingblock>
<div class=content>
<pre class=highlight><code class=language-json data-lang=json>{
    &#34;name&#34;: &#34;CoolCorp&#34;,
    &#34;location&#34;: &#34;Paris&#34;,
    &#34;creationDate&#34;: &#34;2021-10-29&#34;
}</code></pre>
</div>
</div>
</div>
</div>
<div class=sect1>
<h2 id=_ajouter_la_dépendance_nécessaire>Ajouter la dépendance nécessaire</h2>
<div class=sectionbody>
<div class=paragraph>
<p>Avant tout, il convient d’ajouter la dépendance "Spring REST Docs" au projet :</p>
</div>
<div class=listingblock>
<div class=title>Extrait du fichier <a href=https://github.com/alainncls/demo-spring-rest-docs/blob/main/pom.xml target=_blank rel=noopener><code>pom.xml</code></a> :</div>
<div class=content>
<pre class=highlight><code class=language-xml data-lang=xml>        &lt;dependency&gt;
            &lt;groupId&gt;org.springframework.restdocs&lt;/groupId&gt;
            &lt;artifactId&gt;spring-restdocs-mockmvc&lt;/artifactId&gt;
            &lt;scope&gt;test&lt;/scope&gt;
        &lt;/dependency&gt;</code></pre>
</div>
</div>
<div class=paragraph>
<p>Quant au reste des dépendances constituant cette application, inutile de les lister ici, elles sont très classiques et indépendantes de l’outil générant la documentation.</p>
</div>
</div>
</div>
<div class=sect1>
<h2 id=_modifier_ses_tests_de_controller_pour_générer_de_la_documentation>Modifier ses tests de Controller pour générer de la documentation</h2>
<div class=sectionbody>
<div class=paragraph>
<p>Il est alors possible de regarder les tests et d’y ajouter des instructions dédiées à générer les éléments qui nous intéressent. Concentrons sur le test de la requête permettant de récupérer une <code>Company</code> à partir de son ID.</p>
</div>
<div class=paragraph>
<p><em>À noter que je me suis contenté de mocker la couche de service pour ces tests de controller, il ne s’agit donc clairement pas de tests end-to-end.</em></p>
</div>
<div class=listingblock>
<div class=title>Extrait de <a href=https://github.com/alainncls/demo-spring-rest-docs/blob/main/src/test/java/fr/alainncls/demospringrestdocs/controller/CompanyControllerTest.java target=_blank rel=noopener><code>CompanyControllerTest</code></a> :</div>
<div class=content>
<pre class=highlight><code class=language-java data-lang=java>    @Test
    void getCompany() throws Exception {
        final String ID = &#34;ID_1&#34;;

        when(companyService.getCompany(ID)).thenReturn(company1);

        this.mockMvc.perform(RestDocumentationRequestBuilders.get(&#34;/companies/{id}&#34;, ID)) // <b class=conum>(1)</b>
                .andExpect(handler().handlerType(CompanyController.class)) // <b class=conum>(2)</b>
                .andExpect(handler().methodName(&#34;getCompany&#34;))
                .andDo(print())
                .andExpect(status().isOk())
                .andExpect(content().json(objectMapper.writeValueAsString(company1)))
                .andDo(document( // <b class=conum>(3)</b>
                        &#34;getCompany&#34;,
                        ControllerTestUtils.preprocessRequest(),
                        ControllerTestUtils.preprocessResponse(),
                        pathParameters(parameterWithName(&#34;id&#34;).description(&#34;The requested company id&#34;)), // <b class=conum>(4)</b>
                        responseFields( // <b class=conum>(5)</b>
                                fieldWithPath(&#34;id&#34;).description(&#34;The company unique ID&#34;),
                                fieldWithPath(&#34;name&#34;).description(&#34;The company name&#34;),
                                fieldWithPath(&#34;location&#34;).description(&#34;The company location&#34;),
                                fieldWithPath(&#34;creationDate&#34;).description(&#34;The company creation date&#34;))));
    }</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Première nouveauté : on utilise un <code>RestDocumentationRequestBuilders</code> pour émettre la requête plutôt qu’un traditionnel <code>MockMvcRequestBuilders</code>. La différence ? Il est chargé de capturer les informations de la requête pour la documenter.</p>
</li>
<li>
<p>On déroule les tests habituels : vérifier que la requête est traitée par la méthode <code>getCompany()</code> du <code>CompanyController</code>, que la réponse porte le code HTTP <code>200</code> et contient l’objet prévu.</p>
</li>
<li>
<p>Nouvelle instruction ! Ici on lance la génération de documentation, sous le nom de "getCompany" pour cette requête.<br>
<em>Oublions les 2 lignes suivantes pour le moment.</em></p>
</li>
<li>
<p>Documentons la partie variable de l’URL : l’ID de la <code>Company</code> est passé en "path parameter", nous pouvons le décrire (même si dans notre cas ce paramètre est assez facilement compréhensible).</p>
</li>
<li>
<p>Documentons la réponse de la requête : nous pouvons décrire chaque champ constituant la <code>Company</code>.</p>
</li>
</ol>
</div>
<div class=paragraph>
<p>Désormais, si vous ajoutez un champ dans l’objet <code>Company</code> sans le documenter dans ce test, il ne passera plus. Idem si vous supprimez un champ, le test ne passera plus, car il cherchera à documenter un élément qui n’existe pas. Il s’agit donc d’une nouvelle sécurité : votre API ne pourra plus évoluer sans que vous en ayez totalement conscience !</p>
</div>
<div class=paragraph>
<p>Nous avons donc un test qui documente le cas passant le plus évident : lorsqu’une <code>Company</code> correspond à l’ID demandé est trouvée. Lançons-nous dans un nouveau test pour le cas contraire.</p>
</div>
<div class=listingblock>
<div class=title>Extrait de <a href=https://github.com/alainncls/demo-spring-rest-docs/blob/main/src/test/java/fr/alainncls/demospringrestdocs/controller/CompanyControllerTest.java target=_blank rel=noopener><code>CompanyControllerTest</code></a> avec le test d’une erreur</div>
<div class=content>
<pre class=highlight><code class=language-java data-lang=java>    @Test
    void getCompanyNotFound() throws Exception {
        final String ID = &#34;ID_3&#34;;

        when(companyService.getCompany(ID)).thenThrow(new CompanyNotFoundException());

        this.mockMvc.perform(RestDocumentationRequestBuilders.get(&#34;/companies/{id}&#34;, ID))
                .andExpect(handler().handlerType(CompanyController.class))
                .andExpect(handler().methodName(&#34;getCompany&#34;))
                .andDo(print())
                .andExpect(status().isNotFound())
                .andDo(document(
                        &#34;getCompanyNotFound&#34;, // <b class=conum>(1)</b>
                        ControllerTestUtils.preprocessRequest(),
                        ControllerTestUtils.preprocessResponse()));
    }</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Comme dans le test précédent, on ajoute l’instruction <code>document(…​)</code>, cette fois-ci avec un nouvel identifiant ("getCompanyNotFound") pour différencier la documentation générée dans ce nouveau cas.</p>
</li>
</ol>
</div>
<div class=paragraph>
<p>En revanche, il n’est pas ici utile de générer plus de documentation, dans la mesure où la description du "path parameter" a déjà été faite dans le test précédent, et où la requête ne renvoie rien d’autre qu’une erreur HTTP <code>404</code>.</p>
</div>
<div class=paragraph>
<p>En lançant les 2 tests que nous venons de voir, des fichiers (on parle de "snippets") vont être générés sous <code>target/generated-snippets</code>. Et comme par hasard, il s’agit de fichiers <code>.adoc</code> !</p>
</div>
<div class=imageblock>
<div class=content>
<img src=generated.png alt="Aperçu des fichiers générés">
</div>
<div class=title>Figure 1. Aperçu des fichiers générés</div>
</div>
<div class=paragraph>
<p>Si l’on ouvre par exemple <code>getCompany/response-fields.adoc</code>, on pourra y trouver :</p>
</div>
<div class=listingblock>
<div class=content>
<pre class=highlight><code class=language-asciidoc data-lang=asciidoc>|===
|Path|Type|Description

|`+id+`
|`+String+`
|The company unique ID

|`+name+`
|`+String+`
|The company name

|`+location+`
|`+String+`
|The company location

|`+creationDate+`
|`+String+`
|The company creation date

|===</code></pre>
</div>
</div>
<div class=paragraph>
<p>Disons-le : même si l’on voit bien que l’on retrouve des éléments saisis dans le test, ce n’est guère lisible…​ Et puis il n’y a pas moins de 14 fichiers générés pour deux petits tests, qui lirait ça ?!</p>
</div>
<div class=imageblock>
<div class=content>
<img src=one_does_not.jpg alt="One does not simply read 14 files for 1 single endpoint">
</div>
</div>
<div class=paragraph>
<p>Il va donc être temps de générer une documentation plus lisible !</p>
</div>
</div>
</div>
<div class=sect1>
<h2 id=_le_fichier_source_de_la_documentation>Le fichier source de la documentation</h2>
<div class=sectionbody>
<div class=paragraph>
<p>Un fichier pour les gouverner tous. C’est en tout cas l’objectif que nous devons nous fixer pour rendre viable notre documentation.</p>
</div>
<div class=paragraph>
<p>Nous allons donc ajouter un fichier sous <code>source/asciidoctor</code> : <code>index.adoc</code>. Et c’est là que nous injecterons nos "snippets" (et uniquement ceux qui nous intéressent), avec un peu de texte ajouté manuellement pour rendre l’ensemble plus digeste.</p>
</div>
<div class=listingblock>
<div class=title>Extrait du fichier <a href=https://github.com/alainncls/demo-spring-rest-docs/blob/main/src/main/asciidoc/index.adoc target=_blank rel=noopener><code>index.adoc</code></a> qui deviendra la documentation</div>
<div class=content>
<pre class=highlight><code class=language-asciidoc data-lang=asciidoc>=== Get one company // <b class=conum>(1)</b>

.Request
\include::{snippets}/getCompany/http-request.adoc[] // <b class=conum>(2)</b>

.Path parameters
\include::{snippets}/getCompany/path-parameters.adoc[] // <b class=conum>(3)</b>

.Response
\include::{snippets}/getCompany/http-response.adoc[] // <b class=conum>(4)</b>

.Response fields
\include::{snippets}/getCompany/response-fields.adoc[] // <b class=conum>(5)</b>

.Response if the company was not found
\include::{snippets}/getCompanyNotFound/http-response.adoc[] // <b class=conum>(6)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Donnons un petit titre à cette partie de la documentation pour décrire le endpoint documenté en dessous.</p>
</li>
<li>
<p>On injecte un snippet contenant la requête, c’est probablement la meilleure représentation de celle-ci.</p>
</li>
<li>
<p>On injecte un snippet contenant la description du "path parameter".</p>
</li>
<li>
<p>Et le snippet qui illustre la réponse reçue.</p>
</li>
<li>
<p>N’oublions pas le snippet qui décrit les champs de la réponse.</p>
</li>
<li>
<p>Nous avions deux tests sur cet endpoint, pensons à montrer à quoi ressemble la réponse dans le cas où la <code>Company</code> n’est pas trouvée.</p>
</li>
</ol>
</div>
<div class=paragraph>
<p>Pour le moment nous avons juste créé un squelette de documentation. Selon votre IDE, peut-être que vous apercevez déjà un rendu !</p>
</div>
<div class=paragraph>
<p>De manière à améliorer la documentation, vous pouvez évidemment ajouter une table des matières, un titre principal, etc. Il s’agit là de fonctionnalités et annotations de base d’AsciiDoc, je vous propose de ne pas nous y attarder. Vous pouvez avoir une idée de ce que l’on peut faire en regardant le fichier <a href=https://github.com/alainncls/demo-spring-rest-docs/blob/main/src/main/asciidoc/index.adoc><code>index.adoc</code></a> du projet de démonstration.</p>
</div>
</div>
</div>
<div class=sect1>
<h2 id=_générer_la_documentation>Générer la documentation</h2>
<div class=sectionbody>
<div class=paragraph>
<p>Maintenant que nous savons générer des "snippets" et que nous pouvons les rassembler en un seul fichier, il est temps d’automatiser la génération de la page HTML qui contiendra toute la documentation.</p>
</div>
<div class=paragraph>
<p>Pour cela, nous allons nous appuyer sur un plugin Maven : <code>asciidoctor-maven-plugin</code>.</p>
</div>
<div class=listingblock>
<div class=title>La configuration à ajouter dans le fichier <a href=https://github.com/alainncls/demo-spring-rest-docs/blob/main/pom.xml target=_blank rel=noopener><code>pom.xml</code></a></div>
<div class=content>
<pre class=highlight><code class=language-xml data-lang=xml>    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.asciidoctor&lt;/groupId&gt;
                &lt;artifactId&gt;asciidoctor-maven-plugin&lt;/artifactId&gt;
                &lt;version&gt;2.2.1&lt;/version&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;id&gt;generate-docs&lt;/id&gt;
                        &lt;phase&gt;prepare-package&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;process-asciidoc&lt;/goal&gt;
                        &lt;/goals&gt;
                        &lt;configuration&gt;
                            &lt;backend&gt;html&lt;/backend&gt;
                            &lt;doctype&gt;book&lt;/doctype&gt;
                            &lt;attributes&gt;
                                &lt;snippets&gt;${project.build.directory}/generated-snippets&lt;/snippets&gt;
                            &lt;/attributes&gt;
                            &lt;logHandler&gt;
                                &lt;outputToConsole&gt;true&lt;/outputToConsole&gt;
                                &lt;failIf&gt;
                                    &lt;severity&gt;DEBUG&lt;/severity&gt;
                                &lt;/failIf&gt;
                            &lt;/logHandler&gt;
                        &lt;/configuration&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
                &lt;dependencies&gt;
                    &lt;dependency&gt;
                        &lt;groupId&gt;org.springframework.restdocs&lt;/groupId&gt;
                        &lt;artifactId&gt;spring-restdocs-asciidoctor&lt;/artifactId&gt;
                        &lt;version&gt;${spring-restdocs.version}&lt;/version&gt;
                    &lt;/dependency&gt;
                &lt;/dependencies&gt;
            &lt;/plugin&gt;

            &lt;plugin&gt;
                &lt;groupId&gt;org.jacoco&lt;/groupId&gt;
                &lt;artifactId&gt;jacoco-maven-plugin&lt;/artifactId&gt;
                &lt;version&gt;${jacoco-maven-plugin.version}&lt;/version&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;id&gt;prepare-agent&lt;/id&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;prepare-agent&lt;/goal&gt;
                        &lt;/goals&gt;
                    &lt;/execution&gt;
                    &lt;execution&gt;
                        &lt;id&gt;generate-report&lt;/id&gt;
                        &lt;phase&gt;verify&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;report&lt;/goal&gt;
                        &lt;/goals&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;</code></pre>
</div>
</div>
<div class=paragraph>
<p>Ce code permet de générer une page HTML en piochant dans le répertoire <code>target/generated-snippets</code>, tout en bloquant le build en cas d’erreur rencontrée (snippet manquant, etc.).</p>
</div>
<div class=paragraph>
<p>En exécutant une commande comme <code>mvn package</code>, les tests seront exécutés, donc les snippets générés et finalement la page <code>index.html</code> sera créée à partir du fichier <code>index.adoc</code>. Et on peut la retrouver dans <code>target/generated-docs</code>.</p>
</div>
<div class=imageblock>
<div class=content>
<img src=apercu_html.png alt="Aperçu de la page HTML générée">
</div>
<div class=title>Figure 2. Aperçu de la page HTML générée</div>
</div>
<hr>
<div class=paragraph>
<p>Nous avons donc vu comment générer une page HTML décrivant les endpoints d’une application Spring Boot grâce à Spring REST Docs, sans refactorer tous les tests de controller.</p>
</div>
<div class=paragraph>
<p>L’outil est assez complet et il resterait encore plein de petits détails à montrer pour être plus exhaustif. Mais je vous propose d’attendre un article présentant des bonus !</p>
</div>
<hr>
<div class=paragraph>
<p><strong>Liens utiles :</strong></p>
</div>
<div class=ulist>
<ul>
<li>
<p><a href=https://docs.spring.io/spring-restdocs/docs/current/reference/html5/ target=_blank rel=noopener>Documentation de Spring REST Docs</a></p>
</li>
<li>
<p><a href=https://github.com/spring-projects/spring-restdocs/tree/main/samples/rest-notes-spring-data-rest target=_blank rel=noopener>Un projet d’exemple fourni par Spring</a></p>
</li>
<li>
<p><a href=https://github.com/alainncls/demo-spring-rest-docs target=_blank rel=noopener>Mon projet de démonstration</a></p>
</li>
</ul>
</div>
<hr>
<div class=paragraph>
<p><strong>Les autres articles de cette série :</strong></p>
</div>
<div class=ulist>
<ul>
<li>
<p><strong>Partie 1</strong> : <a href=https://alainnicolas.fr/blog/make-documentation-great-again-part-1/ target=_blank rel=noopener>Introduction à la notion de "Documentation as Code"</a></p>
</li>
<li>
<p><strong>Partie 3</strong> : <a href=https://alainnicolas.fr/blog/make-documentation-great-again-bonus/ target=_blank rel=noopener>Aller plus loin avec Spring REST Docs</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="content md:flex-col md:w-72 text-center">
<div class="bg-stone-100 px-4 pb-4 rounded">
<div>
<h4 class=subtitle><i class="fas fa-calendar-alt"></i> Date</h4>
<time datetime=2021-11-08T00:00:00+02:00>
8 novembre 2021
</time>
</div>
<div>
<h4 class=subtitle><i class="fas fa-pen"></i> Auteur</h4>
<div class=text-center>
<div class=mb-4>
<figure>
<a href=https://blog.talanlabs.com/authors/alain-nicolas/><img class="h-36 w-36 m-0 inline-block object-cover rounded-full border border-gray-100" alt="Avatar Alain NICOLAS" src=https://blog.talanlabs.com/authors/alain_nicolas.png></a>
</figure>
</div>
<div>
<h1 class="text-3xl pb-0 text-center font-medium"><a href=https://blog.talanlabs.com/authors/alain-nicolas/>Alain NICOLAS</a></h1>
<p class="mt-0 mb-2">Développeur Blockchain & DLT</p>
</div>
<div class=mb-6>
<a href=https://twitter.com/alain_ncls target=_blank class="icon is-medium"><i class="fab fa-lg fa-twitter text-[#1DA1F2]"></i></a>
<a href=https://www.linkedin.com/in/alainnicolas target=_blank class="icon is-medium"><i class="fab fa-lg fa-linkedin text-[#0077B5]"></i></a>
<a href=https://github.com/alainncls target=_blank class="icon is-medium"><i class="fab fa-lg fa-github"></i></a>
<a class="icon is-medium" href=https://alainncls.medium.com/ target=_blank><i class="fab fa-lg fa-medium"></i></a>
<a href=https://alainnicolas.fr target=_blank class="icon is-medium"><i class="fas fa-lg fa-link"></i></a>
</div>
</div>
</div>
<div>
<h4 class=subtitle><i class="fas fa-hashtag"></i> Catégories</h4>
<a class="py-0.5 px-4 my-2 rounded bg-cyan-500 text-white whitespace-nowrap" href=/categories/craft>craft</a>
<a class="py-0.5 px-4 my-2 rounded bg-cyan-500 text-white whitespace-nowrap" href=/categories/back>back</a>
</div>
<div>
<h4 class=subtitle><i class="fas fa-hashtag"></i> Tags</h4>
<a class="py-0.5 px-4 my-2 rounded bg-indigo-500 text-white whitespace-nowrap hover:bg-indigo-200 hover:text-slate-900" href=/tags/asciidoc>#AsciiDoc</a>
<a class="py-0.5 px-4 my-2 rounded bg-indigo-500 text-white whitespace-nowrap hover:bg-indigo-200 hover:text-slate-900" href=/tags/spring-rest-docs>#Spring REST Docs</a>
<a class="py-0.5 px-4 my-2 rounded bg-indigo-500 text-white whitespace-nowrap hover:bg-indigo-200 hover:text-slate-900" href=/tags/java>#Java</a>
<a class="py-0.5 px-4 my-2 rounded bg-indigo-500 text-white whitespace-nowrap hover:bg-indigo-200 hover:text-slate-900" href=/tags/spring-boot>#Spring Boot</a>
</div>
</div>
</div>
</div>
<aside>
<h4 class="subtitle mt-10 mb-8"><i class="fas fa-forward"></i> Vous aimerez peut-être...</h4>
<div class="grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3">
<div class=mb-3>
<a href=/make-documentation-great-again-part-1/>
<img class="border object-cover w-full m-0 max-w-md" src=/make-documentation-great-again-part-1/cover_hu0f73a737382d5f3ed5a047837ff42b5b_5196158_350x180_resize_q75_box.jpg width=350 height=180 alt="illustration de l'article">
</a>
<div>
<div class=mt-3>
<a class="py-0.5 px-4 my-2 rounded bg-cyan-500 text-white whitespace-nowrap" href=/categories/craft>craft</a>
</div>
<a href=/make-documentation-great-again-part-1/ class="block my-1"><h2 class="text-xl font-bold text-slate-900 py-1">Make documentation great again (1/2)</h2></a>
<div class=my-1>
<span>Alain NICOLAS</span>,
<time datetime=2021-10-01T09:00:00+02:00>
1 octobre 2021
</time>
</div>
<p class="my-1 text-slate-500">Qui aime rédiger la documentation de son produit ou de son API ? Qui en a marre de trouver des documentations …</p>
</div>
</div>
<div class=mb-3>
<a href=/microservices-partie-4-spring-boot/>
<img class="border object-cover w-full m-0 max-w-md" src=/microservices-partie-4-spring-boot/cover_hu0e084678f742c04a704b22a2c885b5c3_5897_350x180_resize_box_3.png width=350 height=180 alt="illustration de l'article">
</a>
<div>
<div class=mt-3>
<a class="py-0.5 px-4 my-2 rounded bg-cyan-500 text-white whitespace-nowrap" href=/categories/architecture>architecture</a>
<a class="py-0.5 px-4 my-2 rounded bg-cyan-500 text-white whitespace-nowrap" href=/categories/back>back</a>
<a class="py-0.5 px-4 my-2 rounded bg-cyan-500 text-white whitespace-nowrap" href=/categories/cloud>cloud</a>
</div>
<a href=/microservices-partie-4-spring-boot/ class="block my-1"><h2 class="text-xl font-bold text-slate-900 py-1">Les microservices pour une architecture orientée …</h2></a>
<div class=my-1>
<span>François BERTHAULT</span>,
<time datetime=2017-03-14T08:21:08Z>
14 mars 2017
</time>
</div>
<p class="my-1 text-slate-500">Simple comme Spring Boot Cet article s’insère dans la série « microservices » écrite par François Berthault …</p>
</div>
</div>
<div class=mb-3>
<a href=/resultats-sondage-java-ee/>
<img class="border object-cover w-full m-0 max-w-md" src=/resultats-sondage-java-ee/cover_hud63fccb140aa9df16ce9a513b39346c2_108055_350x180_resize_q75_box.jpg width=350 height=180 alt="illustration de l'article">
</a>
<div>
<div class=mt-3>
<a class="py-0.5 px-4 my-2 rounded bg-cyan-500 text-white whitespace-nowrap" href=/categories/back>back</a>
</div>
<a href=/resultats-sondage-java-ee/ class="block my-1"><h2 class="text-xl font-bold text-slate-900 py-1">Java EE, nouvelle orientation : les résultats du …</h2></a>
<div class=my-1>
<span>Alain NICOLAS</span>,
<time datetime=2017-02-23T13:08:10Z>
23 février 2017
</time>
</div>
<p class="my-1 text-slate-500">Résumé des épisodes précédents…​
Depuis plusieurs mois la communauté Java est en émoi.</p>
</div>
</div>
</div>
</aside>
</div>
<footer class="w-full bg-gray-100 p-8 dark:bg-black">
<div class="container flex flex-row flex-wrap mx-auto gap-8">
<div class=w-48>
<h3 class="subtitle mt-6 mb-4 ml-0 dark:text-white">Talan Labs</h3>
<nav role=navigation aria-label="footer navigation">
<ul>
<li><a class=dark:text-white href=https://talan.com/metiers/labs/ target=_blank rel=noopener><i class="fas fa-link"></i> Site web</a></li>
<li><a class=dark:text-white href=https://twitter.com/TalanLabs target=_blank rel=noopener><i class="fab fa-twitter"></i> Twitter</a></li>
<li><a class=dark:text-white href=https://www.linkedin.com/company/talanlabs/ target=_blank rel=noopener><i class="fab fa-linkedin"></i> LinkedIn</a></li>
<li><a class=dark:text-white href=https://github.com/TalanLabs target=_blank rel=noopener><i class="fab fa-github"></i> GitHub</a></li>
</ul>
</nav>
</div>
<div class=w-48>
<h3 class="subtitle mt-6 mb-4 ml-0 dark:text-white">Le groupe Talan</h3>
<nav role=navigation aria-label="footer navigation">
<ul>
<li><a class=dark:text-white href=https://talan.com/ target=_blank rel=noopener><i class="fas fa-link"></i> Site
web</a></li>
<li><a class=dark:text-white href=https://twitter.com/talan_fr target=_blank rel=noopener><i class="fab fa-twitter"></i> Twitter</a></li>
<li><a class=dark:text-white href=https://www.linkedin.com/company/talan/ target=_blank rel=noopener><i class="fab fa-linkedin"></i> LinkedIn</a></li>
<li><a class=dark:text-white href=https://www.facebook.com/talan/ target=_blank rel=noopener><i class="fab fa-facebook"></i> Facebook</a></li>
</ul>
</nav>
</div>
</div>
<div class="text-center mt-3 dark:text-white">© 2022 - Le Blog des Labs de Talan - Construit avec <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> et <a href=hhttps://tailwindcss.com target=_blank rel=noopener>Tailwindcss</a></div>
</footer>
<script>var themeToggleDarkIcon=document.getElementById('theme-toggle-dark-icon'),themeToggleLightIcon=document.getElementById('theme-toggle-light-icon'),themeToggleBtn;localStorage.getItem('color-theme')==='dark'||!('color-theme'in localStorage)&&window.matchMedia('(prefers-color-scheme: dark)').matches?(themeToggleLightIcon.classList.remove('hidden'),themeToggleDarkIcon.classList.add('hidden'),document.documentElement.classList.add('dark')):(themeToggleLightIcon.classList.add('hidden'),themeToggleDarkIcon.classList.remove('hidden'),document.documentElement.classList.remove('dark')),themeToggleBtn=document.getElementById('theme-toggle'),themeToggleBtn.addEventListener('click',function(){themeToggleDarkIcon.classList.toggle('hidden'),themeToggleLightIcon.classList.toggle('hidden'),localStorage.getItem('color-theme')?localStorage.getItem('color-theme')==='light'?(document.documentElement.classList.add('dark'),localStorage.setItem('color-theme','dark')):(document.documentElement.classList.remove('dark'),localStorage.setItem('color-theme','light')):document.documentElement.classList.contains('dark')?(document.documentElement.classList.remove('dark'),localStorage.setItem('color-theme','light')):(document.documentElement.classList.add('dark'),localStorage.setItem('color-theme','dark'))})</script><script type=text/javascript>tarteaucitron.init({privacyUrl:"",hashtag:"#tarteaucitron",cookieName:"tarteaucitron",orientation:"bottom",groupServices:!0,showAlertSmall:!1,cookieslist:!1,closePopup:!1,showIcon:!0,iconSrc:"https://blog.talanlabs.com/cookie.png",iconPosition:"BottomRight",adblocker:!1,DenyAllCta:!0,AcceptAllCta:!0,highPrivacy:!0,handleBrowserDNTRequest:!1,removeCredit:!0,moreInfoLink:!0,useExternalCss:!1,useExternalJs:!1,readmoreLink:"",mandatory:!1})</script>
<script type=text/javascript>var tarteaucitronForceLanguage='fr'</script>
<script type=text/javascript>tarteaucitron.user.multiplegtagUa=['UA-40718882-5','G-MED3GXXYSF'],(tarteaucitron.job=tarteaucitron.job||[]).push('multiplegtag')</script>
<script type=text/javascript></script>
</body>
</html>